# Project Generation Scripts

Basic instructions to run the project generation for the Vivado HLS project with hourglass configuration

## Historic: Overview of scripts for producing wiring files.

This documents the python scripts that were historically used to
produce the wiring files. They are now instead produced by the 
L1 track C++ emulation, as documented in ../README.md. The scripts here
should no longer be used, as they produce out-of-date wiring files.

* The master configuration file for hourglass project is generated by:
		
      ./HourGlassConfig.py
    
  The default output file is *wires.input.hourglass*.

  **DATA FORMAT**: Each line in the output file contains a instance of a processing module as well as all its input and output memories. The input memories, the processing module, and the output memories are separated by ">":

       InMem1 InMem2 ... > ProcessModuleX > OutMem1 OutMem2 ...

  The names of the output memories are unique, such that none is written by > 1 proc module to avoid conflicts. (The script does not prevent input memories being read by > 1 proc module, but this is fixed by Wires.py). 

* Create modules and wiring .dat files:

      ./Wires.py wires.input.hourglass

  This script parses the configuration file generated from the previous step and converts it to three output files: 
  *wires.dat*, *memorymodules.dat*, *processingmodules.dat* & *processingmodules_input.dat* (not used).

  These three .dat files contain more or less the same information as the master config file but are reformated for more convenient access in emulation software and later steps. However, if the script detects that a memory is read by > 1 proc module, it clones it to avoid conflicts. Furthermore, as each proc module connects to several memories, it names the input/output pins of the proc module used for each connection.

  **DATA FORMAT**: The key output is *wires.dat*, where each line contains a single instance of a memory modules and the proc modules that read/write to it, together with the I/O pins used. Clones are distinguished by "n1", "n2" etc. in the name. Pin names include "in" or "out" to distinguish read or write.

      Mem  input=> ProcModuleWrite.pinX  output=>ProcModuleRead.pinY

  In *memorymodules.dat* & *processingmodules.dat* list all memories/proc modules, with each line containing a module instance name and its corresponding type, following the format

      ModuleType: ModuleInstance

  (*FIXME*: for memorymodules.dat, there is a third column (e.g. "[36]") that is supposed to indicate the data width of the memory. This number is hardcoded and is likely out of date. It is not used in the later steps for generating top level project, but is used to estimate RAM useage. It may be less confusing if we either remove it or update the numbers or link it to the corresponding HLS memory header files.)

-----------------------------------------------------------------

## Python version and other dependencies
This code is currently not compatible with python 3. Some of the code also depends on ROOT and its python inerface (last tested with version 6.10.00).

There are no other dependencies.
